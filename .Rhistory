scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))
ggplot(HI_AC_unique, aes(x=Month)) +
geom_bar(stat='identity', fill="steelblue")+
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))
ggplot(HI_AC_unique, aes(x=Month,fill=Month)) +
geom_bar(stat='count', fill="steelblue")+
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))
ggplot(HI_AC_unique, aes(x=Month,fill=Month)) +
geom_bar(stat='count', fill="steelblue")+
xlim(c(1,12))
ggplot(HI_AC_unique, aes(x=Month,fill=Month)) +
geom_bar(stat='count', fill="steelblue")+
xlim(c(0,13))
ggplot(HI_AC_unique, aes(x=Month,fill=Month)) +
geom_bar(stat='count', fill="steelblue")+
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))
ggplot(HI_AC_unique, aes(x=Month,fill=as.factor(Month))) +
geom_bar(stat='count', fill="steelblue")+
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))
ggplot(HI_AC_unique, aes(x=as.factor(Month),fill=as.factor(Month))) +
geom_bar(stat='count', fill="steelblue")+
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))
ggplot(HI_AC_unique, aes(x=as.factor(Month),fill=as.factor(Month))) +
geom_bar(stat='count', fill="steelblue")+
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))+
geom_line(size = 1.5, alpha = 0.7, color = "red", group=1)
ggplot(HI_AC_unique, aes(x=as.factor(Month),fill=as.factor(Month))) +
geom_bar(stat='count', fill="steelblue")+
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))
ggplot(HI_AC_unique, aes(x=as.factor(Month),fill=as.factor(Month))) +
geom_bar(stat='count', fill="steelblue")+
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))+
geom_point(stat='count')
ggplot(HI_AC_unique, aes(x=as.factor(Month),fill=as.factor(Month))) +
geom_bar(stat='count', fill="steelblue")+
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))+
geom_line(stat='count')
geom_line(
ggplot(HI_AC_unique, aes(x=as.factor(Month),fill=as.factor(Month))) +
geom_bar(stat='count', fill="steelblue")+
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))+
geom_point()
ggplot(HI_AC_unique, aes(x=as.factor(Month),fill=as.factor(Month))) +
geom_bar(stat='count', fill="steelblue")+
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))+
geom_point()
ggplot(HI_AC_unique, aes(x=as.factor(Month),fill=as.factor(Month))) +
geom_bar(stat='count', fill="steelblue")+
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))+
geom_point(stat='count', fill="red")
ggplot(HI_AC_unique, aes(x=as.factor(Month),fill=as.factor(Month))) +
geom_bar(stat='count', fill="steelblue")+
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))+
geom_point(stat='count', col="red")
ggplot(HI_AC_unique, aes(x=as.factor(Month),fill=as.factor(Month))) +
geom_bar(stat='count', fill="steelblue")+
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))+
geom_point(stat='count', fill="red")
ggplot(HI_AC_unique, aes(x=as.factor(Month),fill=as.factor(Month))) +
geom_bar(stat='count', fill="steelblue")+
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))+
geom_point(stat='count', fill="red")+
ylab('Number of Accident')
ggplot(HI_AC_unique, aes(x=as.factor(Month),fill=as.factor(Month))) +
geom_bar(stat='count', fill="steelblue")+
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))+
geom_point(stat='count', fill="red")+
ylab('Number of Accident')+
theme(axis.text.x = element_text(size = 21),
axis.text.y = element_text(size = 21),axis.title = element_text(size = 21))
ggplot(HI_AC_unique, aes(x=as.factor(Month),fill=as.factor(Month))) +
geom_bar(stat='count', fill="steelblue")+
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))+
geom_point(stat='count', fill="red",size = 1)+
ylab('Number of Accident')+
theme(axis.text.x = element_text(size = 21),
axis.text.y = element_text(size = 21),axis.title = element_text(size = 21))
ggplot(HI_AC_unique, aes(x=as.factor(Month),fill=as.factor(Month))) +
geom_bar(stat='count', fill="steelblue")+
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))+
geom_point(stat='count', fill="red",size = 1)+
ylab('Number of Accident')+
geom_line()+
theme(axis.text.x = element_text(size = 21),
axis.text.y = element_text(size = 21),axis.title = element_text(size = 21))
HI_AC_unique %>%
summarize(Accident_count=n_distinct(ID)) %>%
ggplot(aes(x=Month, y=Accident_count)) +
geom_bar(stat="identity", fill="blue")+
geom_line(size = 1.5, alpha = 0.7, color = "red", group=1) +
geom_point(size = 1) +
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))+
ylab('Number of Accident')+
theme(axis.text.x = element_text(size = 21),
axis.text.y = element_text(size = 21),axis.title = element_text(size = 21))
ggplot(HI_AC_unique, aes(x=as.factor(Month),fill=as.factor(Month))) +
geom_bar(stat='count', fill="steelblue")+
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))+
geom_point(stat='count', fill="red",size = 1)+
ylab('Number of Accident')+
geom_line(aes(x=as.factor(Month), y=ID),stat="count", fill="tan1", colour="sienna3")+
theme(axis.text.x = element_text(size = 21),
axis.text.y = element_text(size = 21),axis.title = element_text(size = 21))
ggplot(HI_AC_unique, aes(x=as.factor(Month),fill=as.factor(Month))) +
geom_bar(stat='count', fill="steelblue")+
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))+
geom_point(stat='count', fill="red",size = 1)+
ylab('Number of Accident')+
geom_line(aes(x=as.factor(Month), y=ID),stat="count", colour="sienna3")+
theme(axis.text.x = element_text(size = 21),
axis.text.y = element_text(size = 21),axis.title = element_text(size = 21))
ggplot(HI_AC_unique, aes(x=as.factor(Month),fill=as.factor(Month))) +
geom_bar(stat='count', fill="steelblue")+
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))+
geom_point(stat='count', fill="red",size = 1)+
ylab('Number of Accident')+
geom_line(aes(x=as.factor(Month), y=as.factor(Month)),stat="count", colour="sienna3")+
theme(axis.text.x = element_text(size = 21),
axis.text.y = element_text(size = 21),axis.title = element_text(size = 21))
ggplot(HI_AC_unique, aes(x=as.factor(Month),fill=as.factor(Month))) +
geom_bar(stat='count', fill="steelblue")+
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))+
geom_point(stat='count', fill="red",size = 1)+
ylab('Number of Accident')+
theme(axis.text.x = element_text(size = 21),
axis.text.y = element_text(size = 21),axis.title = element_text(size = 21))
ggplot(HI_AC_unique, aes(x=as.factor(Month),fill=as.factor(Month))) +
geom_bar(stat='count', fill="steelblue")+
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))
ggplot(HI_AC_unique, aes(x=as.factor(Month),fill=as.factor(Month))) +
geom_bar(stat='count', fill="steelblue")+
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))+
ylab('Number of Accident')+
theme(axis.text.x = element_text(size = 21),
axis.text.y = element_text(size = 21),axis.title = element_text(size = 21))
####################################################################
####################################################################
#########################Load data##################################
####################################################################
####################################################################
load("D:/Github/Honnover-Analysis/HI_AC_LN_ppp/HI_AC_unique.RData")
colnames(HI_AC_unique)[which(colnames(HI_AC_unique) == "Accident_Category")] <- "Severity"
colnames(HI_AC_unique)[which(colnames(HI_AC_unique) == "Accident_Type")] <- "Type"
colnames(HI_AC_unique)[which(colnames(HI_AC_unique) == "Accident_Class")] <- "Class"
colnames(HI_AC_unique)[which(colnames(HI_AC_unique) == "Accident_Bike")] <- "Bike"
colnames(HI_AC_unique)[which(colnames(HI_AC_unique) == "Accident_Car")] <- "Car"
colnames(HI_AC_unique)[which(colnames(HI_AC_unique) == "Accident_Pedestrian")] <- "Pedestrian"
colnames(HI_AC_unique)[which(colnames(HI_AC_unique) == "Accident_Motorcycle")] <- "Motorcycle"
colnames(HI_AC_unique)[which(colnames(HI_AC_unique) == "Accident_Others")] <- "Others"
colnames(HI_AC_unique)[which(colnames(HI_AC_unique) == "Light_Conditions")] <- "Lighting"
colnames(HI_AC_unique)[which(colnames(HI_AC_unique) == "Road_Conditions")] <- "Road"
save("HI_AC_unique.shp",HI_AC_unique)
save(HI_AC_unique,"HI_AC_unique.shp")
HI_AC_unique <- HI_AC_unique %>% mutate(Time_Period = case_when(as.numeric(Time) >= 00  & as.numeric(Time) <03 ~  "1",
as.numeric(Time) >= 03  & as.numeric(Time) <06 ~  "2",
as.numeric(Time) >= 06  & as.numeric(Time) <09 ~  "3",
as.numeric(Time) >= 09  & as.numeric(Time) <12 ~  "4",
as.numeric(Time) >= 12  & as.numeric(Time) <15 ~  "5",
as.numeric(Time) >= 15  & as.numeric(Time) <18 ~  "6",
as.numeric(Time) >= 18  & as.numeric(Time) <21 ~  "7",
aa <- read_sf(HI_AC_unique)                                                                                                                               as.numeric(Time) >= 21  & as.numeric(Time) <24 ~  "8"))
class(HI_AC_unique)
aa <- as(HI_AC_unique,"Spatial")
class
class(aa)
st_crs(aa)
save(aa,"HI_AC_unique.shp")
st_write(dsn = 'aa', layer = 'something', driver = 'ESRI Shapefile')
st_write(aa,"HI_AC_unique.shp")
st_write(HI_AC_unique,"HI_AC_unique.shp")
X <- rpoispp(100)
sig <- bw.scott(X)
X <- rpoispp(100)
sig <- bw.scott(X)
plot(density(X,sigma=sig))
plot(X,add=T,pch=20,cex=2)
sig
sig <- bw.ppl(X)
plot(density(X,sigma=sig))
plot(X,add=T,pch=20,cex=2)
sig
par(mfrow=c(2,2))
plot(density(X,sigma=sig),main="")
par(mfrow=c(2,2),mar=rep(4,4))
plot(density(X,sigma=sig),main="")
par(mfrow=c(2,2),mar=rep(2,4))
plot(density(X,sigma=sig),main="")
plot(X,add=T,pch=20,cex=2)
par(mfrow=c(2,2),mar=rep(2,4))
plot(density(X,sigma=sig),main=sig)
plot(X,add=T,pch=20,cex=2)
plot(density(X,sigma=0.05),main="0.05")
plot(X,add=T,pch=20,cex=2)
par(mfrow=c(2,2),mar=rep(2,4))
plot(density(X,sigma=sig),main=sig)
plot(X,add=T,pch=20,cex=1)
plot(density(X,sigma=0.05),main="0.05")
plot(X,add=T,pch=20,cex=1)
plot(density(X,sigma=0.1),main="0.1")
plot(X,add=T,pch=20,cex=1)
plot(density(X,sigma=0.5),main="0.5")
plot(X,add=T,pch=20,cex=1)
plot(density(X,sigma=0.8),main="0.5")
plot(X,add=T,pch=20,cex=1)
plot(density(X,sigma=0.05),main="0.05")
plot(X,add=T,pch=20,cex=1)
plot(density(X,sigma=sig),main=sig)
plot(X,add=T,pch=20,cex=1)
X
sig <- bw.CvL(X)
plot(density(X,sigma=sig),main=sig)
plot(X,add=T,pch=20,cex=1)
X <- rpoislpp(0.001,domain(chicago))
X
X <- rpoislpp(0.01,domain(chicago))
X
sig <- bw.scott.iso(X)
sig
par(mfrow=c(2,2),mar=rep(2,4))
plot(density(X,sigma=sig),main=sig)
plot(X,add=T,pch=20,cex=1)
par(mfrow=c(2,2),mar=rep(2,4))
plot(density(X,sigma=sig),main=sig)
plot(density(X,sigma=50),main="50")
plot(density(X,sigma=10),main="10")
plot(density(X,sigma=200),main="200")
npoints(X)/volume(domain(chicago))
load("D:/Github/Honnover-Analysis/HI_AC_LN_ppp/HI_LN_AC_unique.RData")
class(HI_LN_AC_unique)
View(HI_AC_unique)
X$data$Month
X_month <- X
marks(X_month) <- as.numeric(X$data$Month)
X_month$data$marks
X_month_1 <- X_month[X_month$data$marks==1]
X$data$Month
load("D:/GEO-C/Github/Honnover-Analysis/HI_AC_LN_ppp/HI_LN_AC_unique.RData")
load("D:/Github/Honnover-Analysis/HI_AC_LN_ppp/HI_LN_AC_unique.RData")
X$data$Month
X_month <- X
View(HI_LN_AC_unique)
####################################################################
####################################################################
################################month################################
####################################################################
####################################################################
X <- HI_LN_AC_unique
X$data$Month
X_month <- X
marks(X_month) <- as.numeric(X$data$Month)
X_month$data$marks
X_month_1 <- X_month[X_month$data$marks==1]
X_month_2 <- X_month[X_month$data$marks==2]
X_month_3 <- X_month[X_month$data$marks==3]
X_month_4 <- X_month[X_month$data$marks==4]
X_month_5 <- X_month[X_month$data$marks==5]
X_month_6 <- X_month[X_month$data$marks==6]
X_month_7 <- X_month[X_month$data$marks==7]
X_month_8 <- X_month[X_month$data$marks==8]
X_month_9 <- X_month[X_month$data$marks==9]
X_month_10 <- X_month[X_month$data$marks==10]
X_month_11 <- X_month[X_month$data$marks==11]
X_month_12 <- X_month[X_month$data$marks==12]
d_X_month_1 <- densityQuick.lpp(unmark(X_month_1), sigma = bw.scott.iso(unmark(X_month_1)),
positive = TRUE,dimyx=256)
d_X_month_2 <- densityQuick.lpp(unmark(X_month_2), sigma = bw.scott.iso(unmark(X_month_2)),
positive = TRUE,dimyx=256)
d_X_month_3 <- densityQuick.lpp(unmark(X_month_3), sigma = bw.scott.iso(unmark(X_month_3)),
positive = TRUE,dimyx=256)
d_X_month_4 <- densityQuick.lpp(unmark(X_month_4), sigma = bw.scott.iso(unmark(X_month_4)),
positive = TRUE,dimyx=256)
d_X_month_5 <- densityQuick.lpp(unmark(X_month_5), sigma = bw.scott.iso(unmark(X_month_5)),
positive = TRUE,dimyx=256)
d_X_month_6 <- densityQuick.lpp(unmark(X_month_6), sigma = bw.scott.iso(unmark(X_month_6)),
positive = TRUE,dimyx=256)
d_X_month_7 <- densityQuick.lpp(unmark(X_month_7), sigma = bw.scott.iso(unmark(X_month_7)),
positive = TRUE,dimyx=256)
d_X_month_8 <- densityQuick.lpp(unmark(X_month_8), sigma = bw.scott.iso(unmark(X_month_8)),
positive = TRUE,dimyx=256)
d_X_month_9 <- densityQuick.lpp(unmark(X_month_9), sigma = bw.scott.iso(unmark(X_month_9)),
positive = TRUE,dimyx=256)
d_X_month_10 <- densityQuick.lpp(unmark(X_month_10), sigma = bw.scott.iso(unmark(X_month_10)),
positive = TRUE,dimyx=256)
d_X_month_11 <- densityQuick.lpp(unmark(X_month_11), sigma = bw.scott.iso(unmark(X_month_11)),
positive = TRUE,dimyx=256)
d_X_month_12 <- densityQuick.lpp(unmark(X_month_12), sigma = bw.scott.iso(unmark(X_month_12)),
positive = TRUE,dimyx=256)
im_d_month_1 <- raster(as.im(d_X_month_1))
im_d_month_2 <- raster(as.im(d_X_month_2))
im_d_month_3 <- raster(as.im(d_X_month_3))
im_d_month_4 <- raster(as.im(d_X_month_4))
im_d_month_5 <- raster(as.im(d_X_month_5))
im_d_month_6 <- raster(as.im(d_X_month_6))
im_d_month_7 <- raster(as.im(d_X_month_7))
im_d_month_8 <- raster(as.im(d_X_month_8))
im_d_month_9 <- raster(as.im(d_X_month_9))
im_d_month_10 <- raster(as.im(d_X_month_10))
im_d_month_11 <- raster(as.im(d_X_month_11))
im_d_month_12 <- raster(as.im(d_X_month_12))
im_d_month <- stack(im_d_month_1,im_d_month_2,im_d_month_3,im_d_month_4,im_d_month_5,
im_d_month_6,im_d_month_7,im_d_month_8,im_d_month_9,im_d_month_10,
im_d_month_11,im_d_month_12)
names(im_d_month) <- c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec')
qtss_month <- as.vector(sort(c(quantile(im_d_month_1*1000,seq(0,1,len=20)),
quantile(im_d_month_2*1000,seq(0,1,len=20)),
quantile(im_d_month_3*1000,seq(0,1,len=20)),
quantile(im_d_month_4*1000,seq(0,1,len=20)),
quantile(im_d_month_5*1000,seq(0,1,len=20)),
quantile(im_d_month_6*1000,seq(0,1,len=20)),
quantile(im_d_month_7*1000,seq(0,1,len=20)),
quantile(im_d_month_8*1000,seq(0,1,len=20)),
quantile(im_d_month_9*1000,seq(0,1,len=20)),
quantile(im_d_month_10*1000,seq(0,1,len=20)),
quantile(im_d_month_11*1000,seq(0,1,len=20)),
quantile(im_d_month_12*1000,seq(0,1,len=20)))))
spplot(im_d_month*1000,at=qtss_month,col.regions=c(viridis(240),rep("#f03b20",6)),
par.settings=list(fontsize=list(text=18)),colorkey=list(lables=list(cex=1.5,cex.main=1.5)))
names(im_d_month) <- c('Jan','Feb','Mar','Apr','May','Jun','Jul',
'Aug','Sep','Oct','Nov','Dec')
qtss_month <- as.vector(sort(c(quantile(im_d_month_1*1000,seq(0,1,len=20)),
quantile(im_d_month_2*1000,seq(0,1,len=20)),
quantile(im_d_month_3*1000,seq(0,1,len=20)),
quantile(im_d_month_4*1000,seq(0,1,len=20)),
quantile(im_d_month_5*1000,seq(0,1,len=20)),
quantile(im_d_month_6*1000,seq(0,1,len=20)),
quantile(im_d_month_7*1000,seq(0,1,len=20)),
quantile(im_d_month_8*1000,seq(0,1,len=20)),
quantile(im_d_month_9*1000,seq(0,1,len=20)),
quantile(im_d_month_10*1000,seq(0,1,len=20)),
quantile(im_d_month_11*1000,seq(0,1,len=20)),
quantile(im_d_month_12*1000,seq(0,1,len=20)))))
spplot(im_d_month*1000,at=qtss_month,col.regions=c(viridis(240),rep("#f03b20",6)),
par.settings=list(fontsize=list(text=18)),colorkey=list(lables=list(cex=1.5,cex.main=1.5)))
spplot(im_d_month*1000,at=qtss_month,col.regions=c(viridis(240),rep("#f03b20",6)),
par.settings=list(fontsize=list(text=18)),colorkey=list(lables=list(cex=1.5,cex.main=1.5)))
library(tweenr)
?gif_file()
?spplot
spplot(im_d_month*1000,at=qtss_month,col.regions=c(viridis(240),rep("#f03b20",6)),
par.settings=list(fontsize=list(text=18)),colorkey=list(lables=list(cex=1.5,cex.main=1.5)),layout=c(3,4))
spplot(im_d_month*1000,at=qtss_month,col.regions=c(viridis(240),rep("#f03b20",6)),
par.settings=list(fontsize=list(text=18)),colorkey=list(lables=list(cex=1.5,cex.main=1.5)),layout=c(4,3))
spplot(im_d_month*1000,at=qtss_month,col.regions=c(viridis(240),rep("#f03b20",6)),
par.settings=list(fontsize=list(text=18)),colorkey=list(lables=list(cex=1.5,cex.main=1.5)),layout=c(4,3),byrow=TRUE)
spplot(im_d_month*1000,at=qtss_month,col.regions=c(viridis(240),rep("#f03b20",6)),
par.settings=list(fontsize=list(text=18)),colorkey=list(lables=list(cex=1.5,cex.main=1.5)),layout=c(4,3),bycol=TRUE)
spplot(im_d_month*1000,at=qtss_month,col.regions=c(viridis(240),rep("#f03b20",6)),
par.settings=list(fontsize=list(text=18)),colorkey=list(lables=list(cex=1.5,cex.main=1.5)),layout=c(4,3),as.table=TRUE)
spplot(im_d_month*1000,at=qtss_month,col.regions=c(viridis(240),rep("#f03b20",6)),
par.settings=list(fontsize=list(text=18)),colorkey=list(lables=list(cex=1.5,cex.main=1.5)),layout=c(4,3),as.table=FALSE)
spplot(im_d_month*1000,at=qtss_month,col.regions=c(viridis(240),rep("#f03b20",6)),
par.settings=list(fontsize=list(text=18)),colorkey=list(lables=list(cex=1.5,cex.main=1.5)),layout=c(4,3),as.table=TRUE)
spplot(im_d_month*1000,at=qtss_month,col.regions=c(viridis(240),rep("#f03b20",6)),
par.settings=list(fontsize=list(text=18)),colorkey=list(lables=list(cex=1.5,cex.main=1.5)),layout=c(4,3),key.space="bottom")
spplot(im_d_month*1000,at=qtss_month,col.regions=c(viridis(240),rep("#f03b20",6)),
par.settings=list(fontsize=list(text=18)),colorkey=list(lables=list(cex=1.5,cex.main=1.5)),layout=c(4,3),key.space="right")
spplot(im_d_month*1000,at=qtss_month,col.regions=c(viridis(240),rep("#f03b20",6)),
par.settings=list(fontsize=list(text=18)),colorkey=list(lables=list(cex=1.5,cex.main=1.5)),layout=c(4,3),key.space="left")
im_d_month <- stack(im_d_month_1,im_d_month_4,im_d_month_7,im_d_month_10,im_d_month_2,
im_d_month_5,im_d_month_7,im_d_month_11,im_d_month_3,im_d_month_6,
im_d_month_9,im_d_month_12)
im_d_month <- stack(im_d_month_1,im_d_month_4,im_d_month_7,im_d_month_10,
im_d_month_2,im_d_month_5,im_d_month_8,im_d_month_11,
im_d_month_3,im_d_month_6,im_d_month_9,im_d_month_12)
names(im_d_month) <- c('Jan','Apr','Jul','Oct',
'Feb','May','Aug','NOV',
'Mar','Jun','Sep','Dec')
qtss_month <- as.vector(sort(c(quantile(im_d_month_1*1000,seq(0,1,len=20)),
quantile(im_d_month_2*1000,seq(0,1,len=20)),
quantile(im_d_month_3*1000,seq(0,1,len=20)),
quantile(im_d_month_4*1000,seq(0,1,len=20)),
quantile(im_d_month_5*1000,seq(0,1,len=20)),
quantile(im_d_month_6*1000,seq(0,1,len=20)),
quantile(im_d_month_7*1000,seq(0,1,len=20)),
quantile(im_d_month_8*1000,seq(0,1,len=20)),
quantile(im_d_month_9*1000,seq(0,1,len=20)),
quantile(im_d_month_10*1000,seq(0,1,len=20)),
quantile(im_d_month_11*1000,seq(0,1,len=20)),
quantile(im_d_month_12*1000,seq(0,1,len=20)))))
spplot(im_d_month*1000,at=qtss_month,col.regions=c(viridis(240),rep("#f03b20",6)),
par.settings=list(fontsize=list(text=18)),colorkey=list(lables=list(cex=1.5,cex.main=1.5)),layout=c(4,3))
setwd("D:/Github/Honnover-Analysis/HI_AC_LN_ppp/images - spatial intensity")
png("im_d_month.png",height = 800,width = 800)
spplot(im_d_month*1000,at=qtss_month,col.regions=c(viridis(240),rep("#f03b20",6)),
par.settings=list(fontsize=list(text=18)),colorkey=list(lables=list(cex=1.5,cex.main=1.5)),layout=c(4,3))
dev.off()
png("im_d_month.png",height = 700,width = 700)
spplot(im_d_month*1000,at=qtss_month,col.regions=c(viridis(240),rep("#f03b20",6)),
par.settings=list(fontsize=list(text=18)),colorkey=list(lables=list(cex=1.5,cex.main=1.5)),layout=c(4,3))
dev.off()
png("im_d_month.png",height = 600,width = 700)
spplot(im_d_month*1000,at=qtss_month,col.regions=c(viridis(240),rep("#f03b20",6)),
par.settings=list(fontsize=list(text=18)),colorkey=list(lables=list(cex=1.5,cex.main=1.5)),layout=c(4,3))
dev.off()
png("im_d_month.png",height = 500,width = 700)
spplot(im_d_month*1000,at=qtss_month,col.regions=c(viridis(240),rep("#f03b20",6)),
par.settings=list(fontsize=list(text=18)),colorkey=list(lables=list(cex=1.5,cex.main=1.5)),layout=c(4,3))
dev.off()
load("D:/Github/Honnover-Analysis/HI_AC_LN_ppp/HI_LN_AC_unique.RData")
load("D:/Github/Honnover-Analysis/HI_AC_LN_ppp/HI_LN_AC_unique.RData")
X <- HI_LN_AC_unique
X_unmark <- unmark(X)
npoints(X_unmark)
d_X_unmark <- densityQuick.lpp(X_unmark, sigma = bw.scott.iso(X_unmark),
positive = TRUE,dimyx=256,diggle = TRUE,edge2D = TRUE)
plot(d_X_unmark*1000,main="",ribwid=0.04,ribsep=0.02,cex.axis=2)
im_d_ker <- raster(as.im(d_X_unmark))
qts_ker <- as.vector(sort(c(quantile(im_d_ker*1000,seq(0,1,len=40)))))
spplot(im_d_ker*1000,at=qts_ker,col.regions=c(viridis(40),"#f03b20"),
par.settings=list(fontsize=list(text=16)),colorkey=list(lables=list(cex=1.5,cex.main=1.5)))
install.packages(c("devtools", "Rserve"))
library(Rserve)
Rserve()
class(d_X_unmark)
d_X_unmark
class(im_d_ker)
raster::shapefile()
raster::shapefile(d_X_count,"ali.shp")
d_X_count
im_d_ker <- raster(as.im(d_X_unmark))
d_X_unmark <- densityQuick.lpp(X_unmark, sigma = bw.scott.iso(X_unmark),
positive = TRUE,dimyx=256,diggle = TRUE,edge2D = TRUE)
pkg = c("devtools","dplyr","plyr","lattice","tibble","rgdal","rgl","parallel",
"tidyverse","tidyr","XML","sp","sf","spatstat","spatstat.utils",
"stlnpp","sparr","stplanr","raster","ggplot2","ggthemes","viridis",
"ggmap","leaflet","maptools","mapview","reshape","reshape2","plotly",
"ggvis","gganimate","gridExtra")
easypackages::libraries(pkg)
load("D:/Github/Honnover-Analysis/HI_AC_LN_ppp/HI_LN_AC_unique.RData")
X <- HI_LN_AC_unique
X_unmark <- unmark(X)
npoints(X_unmark)
d_X_unmark <- densityQuick.lpp(X_unmark, sigma = bw.scott.iso(X_unmark),
positive = TRUE,dimyx=256,diggle = TRUE,edge2D = TRUE)
################################################
################################################
####################Image#######################
################################################
################################################
library(raster)
im_d_ker <- raster(as.im(d_X_unmark))
qts_ker <- as.vector(sort(c(quantile(im_d_ker*1000,seq(0,1,len=40)))))
raster(im_d_ker,"ali.shp")
raster:shapefile(im_d_ker,"ali.shp")
raster:shapefile(im_d_ker,"ali.shp")
raster:shapefile(im_d_ker,"im_d_ker.shp")
raster:shapefile(im_d_ker,"im_d_ker.shp",warnPRJ=T)
r
r<-rasterToPolygons(im_d_ker)
class(r)
setwd("D:/Github/Honnover-Analysis/HI_AC_LN_ppp")
write_sf(r,"im_d_ker.shp")
write.sf(r,"im_d_ker.shp")
write_sf(r,"im_d_ker.shp")
r <- as(r,"spatial")
r <- as(r,"Spatial")
write_sf(r,"im_d_ker.shp")
plot(r)
plot(r)
dev.off()
plot(r)
r
r<-rasterToPolygons(im_d_ker)
r <- as(r,"Spatial")
r
r<-rasterToPolygons(im_d_ker)
r
plot(r)
im_d_ker
?writeRaster
raster::writeRaster(im_d_ker,"im_d_ker.tif")
d_X_unmark <- densityQuick.lpp(X_unmark, sigma = bw.scott.iso(X_unmark),
positive = TRUE,dimyx=256,diggle = TRUE,edge2D = TRUE,at=point)
d_X_unmark <- densityQuick.lpp(X_unmark, sigma = bw.scott.iso(X_unmark),
positive = TRUE,dimyx=256,diggle = TRUE,edge2D = TRUE,at="point")
im_d_ker <- raster(as.im(d_X_unmark))
qts_ker <- as.vector(sort(c(quantile(im_d_ker*1000,seq(0,1,len=40)))))
class(d_X_unmark)
plot(d_X_unmark*1000,main="",ribwid=0.04,ribsep=0.02,cex.axis=2)
class(d_X_unmark)
d_X_unmark
plot(d_X_unmark*1000,main="",ribwid=0.04,ribsep=0.02,cex.axis=2)
png("d_X_unmark_color.png",height = 800,width = 800)
plot(d_X_unmark*1000,main="",ribwid=0.04,ribsep=0.02,cex.axis=2)
plot(d_X_unmark*1000,main="",ribwid=0.04,ribsep=0.02,cex.axis=2)
