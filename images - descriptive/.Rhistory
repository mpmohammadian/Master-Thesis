scale_fill_discrete(labels = c("Severe","Slight"))+
labs(x="Day",y="Number of Accident",fill="Severity of Accident")+
scale_x_discrete(labels = c('Sun.','Mon.','Tue.','Wed.','Thu.','Fri.','Sat.'))+
theme(text = element_text(size = 20))+
ggtitle('')
dev.off()
png("Accident_weekday_Category_bar.png",height = 500,width = 500)
ggplot(aes(x = Weekday, fill = Severity), data = HI_AC_unique) +
geom_bar(stat = 'count', position = position_dodge(preserve="single")) +
scale_fill_discrete(labels = c("Severe","Slight"))+
labs(x="Day",y="Number of Accident",fill="Severity of Accident")+
scale_x_discrete(labels = c('Sun.','Mon.','Tue.','Wed.','Thu.','Fri.','Sat.'))+
theme(text = element_text(size = 20))+
ggtitle('')
dev.off()
png("Accident_weekday_Category_bar.png",height = 400,width = 500)
ggplot(aes(x = Weekday, fill = Severity), data = HI_AC_unique) +
geom_bar(stat = 'count', position = position_dodge(preserve="single")) +
scale_fill_discrete(labels = c("Severe","Slight"))+
labs(x="Day",y="Number of Accident",fill="Severity of Accident")+
scale_x_discrete(labels = c('Sun.','Mon.','Tue.','Wed.','Thu.','Fri.','Sat.'))+
theme(text = element_text(size = 20))+
ggtitle('')
dev.off()
png("Accident_weekday_Category_bar.png",height = 400,width = 600)
ggplot(aes(x = Weekday, fill = Severity), data = HI_AC_unique) +
geom_bar(stat = 'count', position = position_dodge(preserve="single")) +
scale_fill_discrete(labels = c("Severe","Slight"))+
labs(x="Day",y="Number of Accident",fill="Severity of Accident")+
scale_x_discrete(labels = c('Sun.','Mon.','Tue.','Wed.','Thu.','Fri.','Sat.'))+
theme(text = element_text(size = 20))+
ggtitle('')
dev.off()
png("Accident_weekday_Category_bar.png",height = 400,width = 600)
ggplot(aes(x = Weekday, fill = Severity), data = HI_AC_unique) +
geom_bar(stat = 'count', position = position_dodge(preserve="single")) +
scale_fill_discrete(labels = c("Severe","Slight"))+
labs(x="Day",y="Number of Accident",fill="Severity of Accident")+
scale_x_discrete(labels = c('Sun.','Mon.','Tue.','Wed.','Thu.','Fri.','Sat.'))+
theme(text = element_text(size = 25))+
ggtitle('')
dev.off()
?element_text
png("Accident_weekday_Category_bar.png",height = 400,width = 600)
ggplot(aes(x = Weekday, fill = Severity), data = HI_AC_unique) +
geom_bar(stat = 'count', position = position_dodge(preserve="single")) +
scale_fill_discrete(labels = c("Severe","Slight"))+
labs(x="Day",y="Number of Accident",fill="Severity of Accident")+
scale_x_discrete(labels = c('Sun.','Mon.','Tue.','Wed.','Thu.','Fri.','Sat.'))+
theme(text = element_text(size = 25),
legend.title=element_text(size=10),
legend.text=element_text(size=9) )+
ggtitle('')
dev.off()
png("Accident_weekday_Category_bar.png",height = 400,width = 600)
ggplot(aes(x = Weekday, fill = Severity), data = HI_AC_unique) +
geom_bar(stat = 'count', position = position_dodge(preserve="single")) +
scale_fill_discrete(labels = c("Severe","Slight"))+
labs(x="Day",y="Number of Accident",fill="Severity of Accident")+
scale_x_discrete(labels = c('Sun.','Mon.','Tue.','Wed.','Thu.','Fri.','Sat.'))+
theme(text = element_text(size = 20),
legend.title=element_text(size=15),
legend.text=element_text(size=15) )+
ggtitle('')
dev.off()
png("Accident_weekday_Category_bar.png",height = 400,width = 600)
ggplot(aes(x = Weekday, fill = Severity), data = HI_AC_unique) +
geom_bar(stat = 'count', position = position_dodge(preserve="single")) +
scale_fill_discrete(labels = c("Severe","Slight"))+
labs(x="Day",y="Number of Accident",fill="Severity of Accident")+
scale_x_discrete(labels = c('Sun.','Mon.','Tue.','Wed.','Thu.','Fri.','Sat.'))+
theme(text = element_text(size = 20),
legend.title=element_text(size=17),
legend.text=element_text(size=17))+
ggtitle('')
dev.off()
png("Accident_weekday_Category_bar.png",height = 400,width = 600)
ggplot(aes(x = Weekday, fill = Severity), data = HI_AC_unique) +
geom_bar(stat = 'count', position = position_dodge(preserve="single")) +
scale_fill_discrete(labels = c("Severe","Slight"))+
labs(x="Day",y="Number of Accident",fill="Severity of Accident")+
scale_x_discrete(labels = c('Sun.','Mon.','Tue.','Wed.','Thu.','Fri.','Sat.'))+
theme(text = element_text(size = 17),
legend.title=element_text(size=17),
legend.text=element_text(size=17))+
ggtitle('')
dev.off()
png("Accident_month_Category_bar.png",height = 400,width = 600)
ggplot(aes(x = Month ,fill = Severity), data = HI_AC_unique) +
geom_bar(stat = 'count', position=position_dodge(preserve="single"))+
labs(x="Month",y='Number of Accident',fill="Severity of Accident")+
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))+
theme(text = element_text(size = 20))+
scale_fill_discrete(labels = c("Fatal","Severe","Slight"))+
ggtitle('')
dev.off()
png("Accident_month_Category_bar.png",height = 400,width = 700)
ggplot(aes(x = Month ,fill = Severity), data = HI_AC_unique) +
geom_bar(stat = 'count', position=position_dodge(preserve="single"))+
labs(x="Month",y='Number of Accident',fill="Severity of Accident")+
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))+
theme(text = element_text(size = 20))+
scale_fill_discrete(labels = c("Fatal","Severe","Slight"))+
ggtitle('')
dev.off()
png("Accident_month_Category_bar.png",height = 400,width = 700)
ggplot(aes(x = Month ,fill = Severity), data = HI_AC_unique) +
geom_bar(stat = 'count', position=position_dodge(preserve="single"))+
labs(x="Month",y='Number of Accident',fill="Severity of Accident")+
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))+
theme(text = element_text(size = 17))+
scale_fill_discrete(labels = c("Fatal","Severe","Slight"))+
ggtitle('')
dev.off()
png("Accident_month_Category_bar.png",height = 400,width = 700)
ggplot(aes(x = Month ,fill = Severity), data = HI_AC_unique) +
geom_bar(stat = 'count', position=position_dodge(preserve="single"))+
labs(x="Month",y='Number of Accident',fill="Severity of Accident")+
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))+
theme(text = element_text(size = 17))+
scale_fill_discrete(labels = c("Severe","Slight"))+
ggtitle('')
dev.off()
png("Accident_month_Category_bar.png",height = 500,width = 800)
ggplot(aes(x = Month ,fill = Severity), data = HI_AC_unique) +
geom_bar(stat = 'count', position=position_dodge(preserve="single"))+
labs(x="Month",y='Number of Accident',fill="Severity of Accident")+
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))+
theme(text = element_text(size = 19))+
scale_fill_discrete(labels = c("Severe","Slight"))+
ggtitle('')
dev.off()
png("Accident_month_Category_bar.png",height = 500,width = 800)
ggplot(aes(x = Month ,fill = Severity), data = HI_AC_unique) +
geom_bar(stat = 'count', position=position_dodge(preserve="single"))+
labs(x="Month",y='Number of Accident',fill="Severity of Accident")+
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))+
theme(text = element_text(size = 20),
legend.title=element_text(size=20),
legend.text=element_text(size=20))+
scale_fill_discrete(labels = c("Severe","Slight"))+
ggtitle('')
dev.off()
load("D:/Github/Honnover-Analysis/HI_AC_LN_ppp/HI_LN_AC_unique.RData")
X <- HI_LN_AC_unique
X_unmark <- unmark(X)
npoints(X_unmark)
plot(X_unmark,pch=20,cols=2,col=4,main="",cex=2.5)
png("accidents1.png",height = 800,width = 800)
par(mar=rep(0,4))
plot(X_unmark,pch=20,cols=2,col=4,main="",cex=2.5)
dev.off()
plot(X_unmark,pch=20,cols=3,col=4,main="",cex=2.5)
plot(X_unmark,pch=20,cols=2,col=4,main="",cex=2.5)
plot(X_unmark,pch=25,cols=2,col=4,main="",cex=2.5)
plot(X_unmark,pch=20,cols=2,col=4,main="",cex=2.5)
plot(X_unmark,pch=20,cols=2,col=3,main="",cex=2.5)
plot(X_unmark,pch=20,cols=2,col=4,main="",cex=2.5)
plot(X_unmark,pch=20,cols=2,col=6,main="",cex=2.5)
plot(X_unmark,pch=20,cols=2,col=5,main="",cex=2.5)
plot(X_unmark,pch=20,cols=2,col=4,main="",cex=2.5)
plot(X_unmark,pch=20,cols=2,col=4,main="",cex=3)
#########################leaflet
merc = CRS("+init=epsg:3857")
WGS84 = CRS("+init=epsg:4326")
meuse.ll = st_transform(X_unmark, WGS84)
meuse.ll = st_transform(HI_AC_unique_ppp, WGS84)
meuse.ll = st_transform(HI_AC_unique, WGS84)
bggMap = get_map(as.vector(st_bbox(HI_AC_unique)), source = "osm", zoom = 13,maptype="toner-lines")
bggMap = get_map(as.vector(st_bbox(HI_AC_unique_ppp)), source = "osm", zoom = 13,maptype="toner-lines")
meuse.ll = st_transform(X_unmark, WGS84)
str(X_unmark)
crs(X_unmark)
st_crs(X_unmark)
meuse.ll = st_transform(X_unmark, 3857)
meuse.ll = sptransform(X_unmark, 3857)
meuse.ll = spTransform(X_unmark, 3857)
meuse.ll = spTransform(HI_LN_AC_unique, 3857)
meuse.ll = st_transform(HI_LN_AC_unique, 3857)
class(HI_AC_unique)
meuse.ll <- as(HI_AC_unique,"Spatial")
####################################################################
####################################################################
##########################Change names##############################
####################################################################
####################################################################
load("D:/Github/HI_AC_LN_ppp/HI_AC__unique_ppp.RData")
HI_AC_unique <- unique(HI_AC_unique_ppp$marks)
class(HI_AC_unique)
class(HI_AC_unique_ppp)
load("D:/Github/Honnover-Analysis/HI_AC_LN_ppp/HI_LN_AC_unique.RData")
class(HI_LN_AC_unique)
X <- HI_LN_AC_unique
X_unmark <- unmark(X)
npoints(X_unmark)
class(X_unmark)
load("D:/Github/Honnover-Analysis/HI_AC_LN_ppp/HI_LN_AC.RData")
load("D:/Github/Honnover-Analysis/HI_AC_LN_ppp/HI_LN_AC.RData")
View(HI_LN_AC)
Y <- unique(HI_LN_AC$data)
View(Y)
load("D:/Github/Honnover-Analysis/HI_AC_LN_ppp/HI_LN_AC_unique.RData")
Y <- HI_LN_AC_unique$data
X <- HI_LN_AC_unique
X_unmark <- unmark(X)
npoints(X_unmark)
crs(X_unmark)
st_crs(X_unmark)
setwd("D:/Github/Honnover-Analysis/data/Hildesheim/HI.AC")
HI_AC <- read_sf("Hildesheim.A.shp")
st_crs(HI_AC)
setwd("D:/Github/Honnover-Analysis/Unfallorte2017_LinRef_Shapefile")
DEA <- read_sf("Unfallorte2017_LinRef.shp")
st_crs(DEA)
X_unmark1 <- X_unmark
st_crs(X_unmark1) <- st_crs(DEA)
X_unmark1 <- as(X_unmark1,"Spatial")
HI_AC <- st_zm(HI_AC)
st_crs(HI_AC) <- st_crs(DEA)
HI_AC  <- st_transform(HI_AC,3857)
HI_AC_unique <- unique(HI_AC)
HI_AC_ppp <- as.ppp(HI_AC)
HI_AC_ppp <- unmark(HI_AC_ppp)
load("D:/Github/Honnover-Analysis/data/Hildesheim/.RData")
load("D:/Github/Honnover-Analysis/data/Hildesheim/Hildesheim.model.Rdata")
load("D:/Github/Honnover-Analysis/HI_AC_LN_ppp/HI_AC__unique_ppp.RData")
View(HI_AC_unique_ppp)
XX <- marks(HI_AC_unique_ppp)
class(XX)
coordinates(XX)<-~x+y
View(XX)
coordinates(XX)<-~LINREFX+LINREFY
class(XX)
#########################leaflet
merc = CRS("+init=epsg:3857")
WGS84 = CRS("+init=epsg:4326")
meuse.ll = st_transform(XX, WGS84)
XX <- as(XX,"Spatial")
meuse.ll = st_transform(XX, WGS84)
XX <- marks(HI_AC_unique_ppp)
View(XX)
xy <- XX[,c(16,17)]
spdf <- SpatialPointsDataFrame(coords = xy, data = XX,
proj4string = CRS("+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"))
class(spdf)
bggMap = get_map(as.vector(st_bbox(spdf)), source = "osm", zoom = 13,maptype="toner-lines")
?get_map
bggMap = get_map(as.vector(st_bbox(spdf)), source = "google", zoom = "auto",maptype="roadmap")
bggMap = get_map(as.vector(st_bbox(spdf)), source = "osm", zoom = "auto",maptype="roadmap")
bggMap = get_map(as.vector(st_bbox(spdf)), source = "osm", zoom = "auto",maptype="satellite")
bggMap = get_map(as.vector(st_bbox(spdf)), source = "osm", zoom = "auto")
bggMap = get_map(as.vector(st_bbox(spdf)), source = 13, zoom = "auto",maptype="satellite")
bggMap = get_map(as.vector(st_bbox(spdf)), source = "google", zoom = 13,maptype="satellite")
bggMap = get_map(as.vector(st_bbox(spdf)), source = "google", zoom = 11,maptype="satellite")
bggMap = get_map(as.vector(st_bbox(spdf)), source = "google", zoom = 9,maptype="satellite")
bggMap = get_map(as.vector(st_bbox(spdf)), source = "google", zoom = 11,maptype="satellite")
class(spdf
)
map <- get_map(location = "Germany", maptype = "hybrid", zoom = 6)
geocode("the white house")
baylor <- "baylor university"
qmap(baylor, zoom = 14)
library(RgoogleMaps)
lon <- c(-140,-110)
lat <- c(48,64)
center = c(mean(lat), mean(lon))
zoom <- 5
terrmap <- GetMap(center=center, zoom=zoom, maptype= "terrain", destfile = "terrain.png")
terrmap
bggMap = GetMap(as.vector(st_bbox(spdf)), source = "google", zoom = 11,maptype="satellite")
?GetMap
bggMap = GetMap("Germany", type = "google", zoom = 12,maptype="satellite")
bggMap = GetMap(as.vector(st_bbox(spdf), type = "google", zoom = 12,maptype="satellite")
bggMap = GetMap(as.vector(st_bbox(spdf)), type = "google", zoom = 12,maptype="satellite")
st_bbox(spdf)
load("C:/Users/Parsa/Desktop/HI_AC_unique.RData")
class(HI_AC_unique)
#########################leaflet
merc = CRS("+init=epsg:3857")
WGS84 = CRS("+init=epsg:4326")
meuse.ll = st_transform(HI_AC_unique, WGS84)
bggMap = get_map(as.vector(st_bbox(meuse.ll)), source = "osm", zoom = 13,maptype="toner-lines")
par(mar = rep(0,4))
plot(st_transform(meuse.ll[,"Count"], merc), bgMap = bggMap, pch = 16, cex = .5)
bggMap = get_map(as.vector(st_bbox(meuse.ll)), source = "osm", zoom = 13,maptype="satellite")
bggMap = get_map(as.vector(st_bbox(meuse.ll)), source = "google", zoom = 13,maptype="toner-lines")
par(mar = rep(0,4))
plot(st_transform(meuse.ll[,"Count"], merc), bgMap = bggMap, pch = 16, cex = .5)
bggMap = get_map(as.vector(st_bbox(meuse.ll)), source = "google", zoom = 13,maptype="satellite")
par(mar = rep(0,4))
plot(st_transform(meuse.ll[,"Count"], merc), bgMap = bggMap, pch = 16, cex = .5)
bggMap = get_map(as.vector(st_bbox(meuse.ll)), source = "google", zoom = 13,maptype="satellite")
par(mar = rep(0,4))
plot(st_transform(meuse.ll[,"Count"], merc), bgMap = bggMap, pch = 16, cex = .5)
?get_map
bggMap = get_map(as.vector(st_bbox(meuse.ll)), source = "google", zoom = 13,maptype="roadmap")
par(mar = rep(0,4))
plot(st_transform(meuse.ll[,"Count"], merc), bgMap = bggMap, pch = 16, cex = .5)
bggMap = get_map(as.vector(st_bbox(meuse.ll)), source = "google", zoom = 13,maptype= "hybrid" )
par(mar = rep(0,4))
plot(st_transform(meuse.ll[,"Count"], merc), bgMap = bggMap, pch = 16, cex = .5)
plot(st_transform(meuse.ll[,"ID"], merc), bgMap = bggMap, pch = 16, cex = .5)
plot(st_transform(meuse.ll[,"ID"], merc), bgMap = bggMap, pch = 20, cex = .5)bggMap = get_map(as.vector(st_bbox(meuse.ll)), source = "osm", zoom = 13,maptype="satellite")
plot(st_transform(meuse.ll[,"ID"], merc), bgMap = bggMap, pch = 20, cex = .5)
plot(st_transform(meuse.ll[,"ID"], merc), bgMap = bggMap, pch = 10, cex = .5)
plot(st_transform(meuse.ll[,"ID"], merc), bgMap = bggMap,col=3, pch = 10, cex = .5)
plot(st_transform(meuse.ll[,"ID"], merc), bgMap = bggMap,col=4, pch = 10, cex = .5)
plot(st_transform(meuse.ll[,"ID"], merc), bgMap = bggMap,col=2, pch = 10, cex = .5)
plot(st_transform(meuse.ll[,"ID"], merc), bgMap = bggMap,col=1, pch = 10, cex = .5)
plot(st_transform(meuse.ll[,"ID"], merc), bgMap = bggMap,col=2, pch = 10, cex = .5)
plot(st_transform(meuse.ll[,"ID"], merc), bgMap = bggMap,col=2, pch = 10, cex = 1.5)
plot(st_transform(meuse.ll[,"ID"], merc), bgMap = bggMap,col=2, pch = 10, cex = .5)
plot(st_transform(meuse.ll[,"ID"], merc), bgMap = bggMap,col=7, pch = 10, cex = .5)
plot(st_transform(meuse.ll[,"ID"], merc), bgMap = bggMap,col="red", pch = 10, cex = .5)
plot(st_transform(meuse.ll[,"Count"], merc), bgMap = bggMap,col="red", pch = 10, cex = .5)
plot(st_transform(meuse.ll[,"Count"], merc), bgMap = bggMap, pch = 10, cex = .5)
setwd("D:/Github/Honnover-Analysis/HI_AC_LN_ppp/images - descriptive")
png("accidents_count.png",height = 800,width = 800)
par(mar=rep(0,4))
plot(st_transform(meuse.ll[,"Count"], merc), bgMap = bggMap, pch = 10, cex = .5)
dev.off()
png("accidents_count.png",height = 800,width = 800)
par(mar=rep(0,4))
plot(st_transform(meuse.ll[,"Count"], merc), bgMap = bggMap, pch = 20, cex = .5)
dev.off()
png("accidents_count.png",height = 800,width = 800)
par(mar=rep(0,4))
plot(st_transform(meuse.ll[,"Count"], merc), bgMap = bggMap, pch = 40, cex = .5)
dev.off()
png("accidents_count.png",height = 800,width = 800)
par(mar=rep(0,4))
plot(st_transform(meuse.ll[,"Count"], merc), bgMap = bggMap, pch = 5, cex = .5)
dev.off()
png("accidents_count.png",height = 800,width = 800)
par(mar=rep(0,4))
plot(st_transform(meuse.ll[,"Count"], merc), bgMap = bggMap, pch = 1, cex = .5)
dev.off()
png("accidents_count.png",height = 800,width = 800)
par(mar=rep(0,4))
plot(st_transform(meuse.ll[,"Count"], merc), bgMap = bggMap, cex = .5)
dev.off()
?plot
plot(st_transform(meuse.ll[,"Count"], merc), bgMap = bggMap,lwd = 1, cex = .5)
plot(st_transform(meuse.ll[,"Count"], merc), bgMap = bggMap,lwd = 2, cex = .5)
png("accidents_count.png",height = 800,width = 800)
par(mar=rep(0,4))
plot(st_transform(meuse.ll[,"Count"], merc), bgMap = bggMap,lwd = 2, cex = .5)
dev.off()
plot(st_transform(meuse.ll[,"Count"], merc), bgMap = bggMap,lwd = 3, cex = .5)
png("accidents_count.png",height = 800,width = 800)
par(mar=rep(0,4))
plot(st_transform(meuse.ll[,"Count"], merc), bgMap = bggMap,lwd = 3, cex = .5)
dev.off()
plot(st_transform(meuse.ll[,"Count"], merc), bgMap = bggMap,lwd = 4, cex = .5)
png("accidents_count.png",height = 800,width = 800)
par(mar=rep(0,4))
plot(st_transform(meuse.ll[,"Count"], merc), bgMap = bggMap,lwd = 4, cex = .5)
dev.off()
png("accidents_ID.png",height = 800,width = 800)
par(mar=rep(0,4))
plot(st_transform(meuse.ll[,"ID"], merc), bgMap = bggMap,lwd = 4, cex = .5)
dev.off()
plot(st_transform(meuse.ll[,"ID"], merc), bgMap = bggMap,col="red",lwd = 4, cex = .5)
png("accidents_ID.png",height = 800,width = 800)
par(mar=rep(0,4))
plot(st_transform(meuse.ll[,"ID"], merc), bgMap = bggMap,col="red",lwd = 4, cex = .5)
dev.off()
png("accidents_ID.png",height = 800,width = 800)
par(mar=rep(0,4))
plot(st_transform(meuse.ll[,"ID"], merc), bgMap = bggMap,col="red",lwd = 4, cex = .5,main="")
dev.off()
setwd("D:/Github/Honnover-Analysis/HI_AC_LN_ppp")
View(HI_AC_unique)
colnames(HI_AC_unique)[which(colnames(HI_AC_unique) == "Road_Condition")] <- "Road"
View(HI_AC_unique)
colnames(HI_AC_unique)[which(colnames(HI_AC_unique) == "Road_Conditions")] <- "Road"
colnames(HI_AC_unique)[which(colnames(HI_AC_unique) == "Light_Conditions")] <- "Lighting"
colnames(HI_AC_unique)[which(colnames(HI_AC_unique) == "AccidentO_thers")] <- "Others"
colnames(HI_AC_unique)[which(colnames(HI_AC_unique) == "Accident_Others")] <- "Others"
colnames(HI_AC_unique)[which(colnames(HI_AC_unique) == "Accident_Motorcycle")] <- "Motorcycle"
colnames(HI_AC_unique)[which(colnames(HI_AC_unique) == "Accident_Pedestrian")] <- "Pedestrian"
colnames(HI_AC_unique)[which(colnames(HI_AC_unique) == "Accident_Car")] <- "Car"
colnames(HI_AC_unique)[which(colnames(HI_AC_unique) == "Accident_Bike")] <- "Bike"
colnames(HI_AC_unique)[which(colnames(HI_AC_unique) == "Accident_Class")] <- "Class"
colnames(HI_AC_unique)[which(colnames(HI_AC_unique) == "Accident_Type")] <- "Type"
colnames(HI_AC_unique)[which(colnames(HI_AC_unique) == "Accident_Category")] <- "Severity"
HI_AC_unique %>%
group_by(Month) %>%
summarize(Accident_count=n_distinct(ID)) %>%
ggplot(aes(x=Month, y=Accident_count)) +
geom_bar(stat="identity", fill="blue")+
geom_line(size = 1.5, alpha = 0.7, color = "red", group=1) +
geom_point(size = 1) +
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))+
ylab('Number of Accident')+
theme(axis.text.x = element_text(size = 21),
axis.text.y = element_text(size = 21),axis.title = element_text(size = 21))
HI_AC_unique$Month
HI_AC_unique$Month <- as.numeric(HI_AC_unique$Month)
HI_AC_unique %>%
group_by(Month) %>%
summarize(Accident_count=n_distinct(ID)) %>%
ggplot(aes(x=Month, y=Accident_count)) +
geom_bar(stat="identity", fill="blue")+
geom_line(size = 1.5, alpha = 0.7, color = "red", group=1) +
geom_point(size = 1) +
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))+
ylab('Number of Accident')+
theme(axis.text.x = element_text(size = 21),
axis.text.y = element_text(size = 21),axis.title = element_text(size = 21))
HI_AC_unique %>%
group_by(Month, Weekday) %>%
summarise("n"=n()) %>%
ggplot(data=., aes(Month, Weekday, fill=n)) +
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))+
scale_y_discrete(labels = c('Sun.','Mon.','Tue.','Wed.','Thu.','Fri.','Sat.'))+
theme(text = element_text(size = 20))+
geom_tile() +
scale_fill_viridis(option="plasma") +
coord_fixed() +
labs(x="Month",y="Day",fill="Number of accident")
dev.off()
ggplot(aes(x = Month, fill = Weekday), data = HI_AC_unique) +
geom_bar(stat = 'count', position = position_dodge(preserve="single")) +
labs(x="Month",y="Number of Accident",fill="Day")+
theme(text = element_text(size = 20))+
scale_fill_discrete(labels = c('Sun.','Mon.','Tue.','Wed.','Thu.','Fri.','Sat.'))+
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))+
ggtitle('')
setwd("D:/Github/Honnover-Analysis/HI_AC_LN_ppp/images - descriptive")
png("Accident_by_month_weekday.png",height = 350,width = 700)
HI_AC_unique %>%
group_by(Month, Weekday) %>%
summarise("n"=n()) %>%
ggplot(data=., aes(Month, Weekday, fill=n)) +
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))+
scale_y_discrete(labels = c('Sun.','Mon.','Tue.','Wed.','Thu.','Fri.','Sat.'))+
theme(text = element_text(size = 20))+
geom_tile() +
scale_fill_viridis(option="plasma") +
coord_fixed() +
labs(x="Month",y="Day",fill="Number of accident")
dev.off()
ggplot(aes(x = Month, fill = Weekday), data = HI_AC_unique) +
geom_bar(stat = 'count', position = position_dodge(preserve="single")) +
labs(x="Month",y="Number of Accident",fill="Day")+
theme(text = element_text(size = 20))+
scale_fill_discrete(labels = c('Sun.','Mon.','Tue.','Wed.','Thu.','Fri.','Sat.'))+
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))+
ggtitle('')
ggplot(aes(x = Month ,fill = Severity), data = HI_AC_unique) +
geom_bar(stat = 'count', position=position_dodge(preserve="single"))+
labs(x="Month",y='Number of Accident',fill="Severity of Accident")+
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))+
theme(text = element_text(size = 20),
legend.title=element_text(size=20),
legend.text=element_text(size=20))+
scale_fill_discrete(labels = c("Severe","Slight"))+
ggtitle('')
HI_AC_unique %>%
group_by(Severity, Month) %>%
summarise("n"=n()) %>%
ggplot(data=., aes(Month,Severity, fill=n)) +
scale_x_discrete(labels = c('Jan','Feb','Mar','Apr','May','June','July',
'Aug','Sep','Oct','Nov','Dec'))+
scale_y_discrete(labels = c("Fatal","Severe","Slight"))+
geom_tile() +
theme(text = element_text(size = 20))+
scale_fill_viridis(option="plasma") +
coord_fixed() +
labs(x="Month",y="Severity of accident",fill="Numer of Accident")
HI_AC_unique_1 <- HI_AC_unique
HI_AC_unique_1$Weekday <- factor(HI_AC_unique_1$Weekday, labels = c('Sun.','Mon.','Tue.','Wed.','Thu.','Fri.','Sat.'))
HI_AC_unique_1$Bike <- factor(HI_AC_unique_1$Bike, labels = c("Not Included","Included"))
HI_AC_unique_1$Severity <- factor(HI_AC_unique_1$Severity, labels = c("Severe","Slight"))
HI_AC_unique_1$Pedestrian <- factor(HI_AC_unique_1$Pedestrian, labels = c("Not Included","Included"))
HI_AC_unique1$Severity <- ifelse(HI_AC_unique1$Severity=="1","2",HI_AC_unique$Severity)
HI_AC_unique_1$Severity <- ifelse(HI_AC_unique_1$Severity=="1","2",HI_AC_unique_1$Severity)
HI_AC_unique_1$Severity <- factor(HI_AC_unique_1$Severity, labels = c("Severe","Slight"))
ggplot(aes(x = Weekday, fill = Severity), data = HI_AC_unique_1) +
geom_bar(stat = 'count', position = position_dodge(preserve="single")) +
scale_fill_discrete(labels = c("Severe","Slight"))+
labs(x="Day",y="Number of Accident",fill="Severity of Accident")+
scale_x_discrete(labels = c('Sun.','Mon.','Tue.','Wed.','Thu.','Fri.','Sat.'))+
theme(text = element_text(size = 17),
legend.title=element_text(size=17),
legend.text=element_text(size=17))+
ggtitle('')
HI_AC_unique %>%
group_by(Severity, Weekday) %>%
summarise("n"=n()) %>%
ggplot(data=., aes(Weekday,Severity, fill=n)) +
scale_x_discrete(labels = c('Sun.','Mon.','Tue.','Wed.','Thu.','Fri.','Sat.'))+
scale_y_discrete(labels = c("Fatal","Severe","Slight"))+
geom_tile() +
scale_fill_viridis(option="plasma") +
theme(text = element_text(size = 20))+
coord_fixed() +
labs(x="Day",y="Severity of Accident",fill="Number of Accident")
